# FP8 FMHA Numerical Verification

## QK MFMA (fwd_fp8_qk_pipe.s)

### Uniform Input Test
- Q = K = 1.0 (FP8), seq=128 (4 K-tiles)
- Expected: S = 4 * 128 = 512 (sum of dot products)
- **Result: S = 512.0 ✓**

### Softmax Test (fwd_fp8_p136.s)
- Q = K = 1.0 (FP8), seq=32
- Expected: P = 1/32 = 0.03125 (uniform attention)
- **Result: P = 0.03125 ✓**
- Row sum: 1.0 ✓

### Random Input Test
- P min >= 0 ✓
- No NaN ✓
- Row sum ≈ 1.0 ✓

## Pitch-136 Layout

Verified zero bank conflicts:
- 64 banks used (all)
- Max 2 hits per bank (optimal)

## MFMA Output Mapping

For `v_mfma_f32_32x32x16_fp8_fp8`:
- mfma_row = (lane & 3) + ((lane >> 3) & 3) * 4 + ((lane >> 2) & 1) * 16
- k_half = 8 if lane >= 32 else 0
- 16 F32 outputs per lane in v[0:15]

## PV MFMA Status

- Not yet verified numerically
- Working on P storage layout to match PV MFMA input requirements
